name: Préparer une émission

on:
  workflow_dispatch:
    inputs:
      collection:
        type: choice
        default: Ailleurs
        options:
        - Ailleurs
        - Bagage
        - Bureau
        - Ouïedire
        required: true
      number:
        default: "999"
        required: true
        type: string
      title:
        type: string
        default: TODO
      authors:
        type: string
        default: TODO

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: andrewthetechie/gha-cookiecutter@v1.1.1
        with:
          template: ./src/skel/emission
          outputDir: ./src/public/assets/emission
          cookiecutterValues: '{
            "collection": "${{ inputs.collection }}",
            "title": "${{ inputs.title }}",
            "number": "${{ inputs.number }}",
            "authors": "${{ inputs.authors }}"
          }'
      - uses: EndBug/add-and-commit@v9.1.1
        with:
          add: './src/public/assets/emission'
          # The message for the commit.
          # Default: 'Commit from GitHub Actions (name of the workflow)'
          message: '${{ inputs.collection }} #${{ inputs.number }} : initialisation du dossier'

          # If this input is set, the action will push the commit to a new branch with this name.
          new_branch: ${{ inputs.collection }}-${{ inputs.number }}